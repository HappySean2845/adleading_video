<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0;">
    <!-- iOS 设备 begin -->
    <meta name="apple-mobile-web-app-title" content="标题">
    <!-- 添加到主屏后的标题（iOS 6 新增） -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta content="no" name="apple-touch-fullscreen">
    <meta content="yes" name="full-screen">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="telephone=yes,email=yes" name="format-detection">
    <meta content="address=no" name="format-detection">
    <title>深夜，出差的老公给我发了一个视频请求</title>
    <link rel="stylesheet" type="text/css" href="css/reset.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <style>
    html,
    body {
        width: 100%;
        height: 100%;
        overflow: hidden;
    }
    </style>
    <script type="text/javascript" src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="js/resLoader.js"></script>
    <!-- 微信JS -->
    <script type="text/javascript" src="http://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
    <!-- 微信JSDK基础JSLoad -->
    <script type="text/javascript" src="http://etude.yiqipaoba.com/util/html/ka/loadJS.js"></script>
    <script type="text/javascript" id="weixinjssdk"></script>
    <script>
    //微信JSDK基础
    var _spurl = window.location.href.split('#')[0];
    loadJS("weixinjssdk", "http://etude.yiqipaoba.com/weixin/ajax/GetWeChatJs.ashx?fromurl=" + encodeURIComponent(_spurl))
    </script>
</head>

<body>
    <div class="all">
        <div class="all" id="loading"></div>
        <div id="play" class="all" style=""></div>
    </div>
    <video id="video" x-webkit-airplay="true" preload="auto" x5-video-player-type="h5" x5-video-player-fullscreen="true" playsinline="true" webkit-playsinline="true" x5-video-orientation="portrait" style="width: 1px; height: 1px;" src="telecom.mp4"></video>
    <div id="content">
        <!-- <div class="inner"><a href="javascript:;" id="replay" class="btn"></a></div> -->
    </div>
    <script>
    //分享后回调方法
    function aftersharesuccess() {}

    function aftershare() {
        $.post('/ajax/PageStatistics.ashx?wxid=10&PageID=20170918&PageUrl=' + encodeURIComponent(location.href) + '&ActionType=2&CustomID=&Openid=');
    }
    //jsdk ready
    wx.ready(function() {

        wx.onMenuShareTimeline({
            title   : '深夜，出差的老公给我发了一个视频请求', // 分享标题
            link    : _spurl, // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致
            imgUrl  : 'http://etude.yiqipaoba.com/util/html/ka/fm.jpg', // 分享图标
            success : function() {
                // 用户确认分享后执行的回调函数
                aftershare();
            },
            cancel: function() {
                // 用户取消分享后执行的回调函数
            }
        });
        wx.onMenuShareAppMessage({
            title   : '深夜，出差的老公给我发了一个视频请求', // 分享标题
            desc    : '短短几分钟究竟发生了什么？', // 分享描述
            link    : _spurl, // 分享链接
            imgUrl  : 'http://etude.yiqipaoba.com/util/html/ka/fm.jpg', // 分享图标
            type    : '', // 分享类型,music、video或link，不填默认为link
            dataUrl : '', // 如果type是music或video，则要提供数据链接，默认为空
            success: function() {
                // 用户确认分享后执行的回调函数
                aftershare();
            },
            cancel: function() {
                // 用户取消分享后执行的回调函数
            }
        });
    });

    $(function() {
        //数据统计
        $.post('/ajax/PageStatistics.ashx?wxid=10&PageID=20170918&PageUrl=' + encodeURIComponent(location.href) + '&ActionType=1&CustomID=&Openid=');
    })
    </script>
    <script>
    $(document).ready(function() {
        // 加载
        $('.btn').click(function() {
            $(".all").hide();
            $("#content").hide();
            var u = navigator.userAgent;
            var winheight = window.innerHeight + 30;
            if (u.indexOf('Android') > -1 || u.indexOf('Adr') > -1) { winheight = window.innerHeight + 84 }
            $("#video").css({ "width": window.innerWidth + "px", "height": winheight + "px", "z-index": "1", "display": "block" });
            var myVideo = document.getElementById("video");
            if (myVideo.paused) {
                myVideo.play();
            }
        });
        $('#play').click(function() {
            $(".all").hide();
            var u = navigator.userAgent;
            var winheight = window.innerHeight + 30;
            if (u.indexOf('Android') > -1 || u.indexOf('Adr') > -1) { winheight = window.innerHeight + 84 }

            $("#video").css({ "width": window.innerWidth + "px", "height": winheight + "px" });
            var myVideo = document.getElementById("video");
            if (myVideo.paused) {
                myVideo.play();
            }
            var endVideo = function() {
                $("#video").css({ "width": "1px", "height": "1px", "z-index": "-1", "display": "none" });
                $("#content").css("opacity", "1");
                $("#content .inner").delay(2000).fadeIn();
            }
            myVideo.addEventListener("ended", endVideo);
        });
        var loader = new resLoader({
            resources: [
                'telecom.mp4',
                'images/ending.jpg',
            ],
            onStart: function(total) {
                console.log('start:' + total);
            },
            onProgress: function(current, total) {
                console.log(current + '/' + total);
                var percent = Math.floor(current / total * 100);
            },
            onComplete: function(total) {
                $('#loading').hide();
                $('#play').show();
            }
        });

        loader.start();
    })
    </script>
</body>

</html>